<div>
<style id="izi-style">
    /** GRUNT INSERT HERE */
</style>


<div class="izi-account center-block">
<div style="padding: 15px 15px 10px" ng-if="barcode && !register">
    <i class="glyphicon glyphicon-remove blanc pull-right hvr-grow" style="cursor: pointer; font-size: 2.1em;"
       ng-click="disconnect()"></i>


    <h4 class="text-center" ng-if="data.CustomerFirstName">Prénom : {{data.CustomerFirstName}}</h4>
    <h4 class="text-center" ng-if="data.CustomerLastName">Nom : {{data.CustomerLastName}}</h4>
    <h4 class="text-center" ng-if="data.CustomerEmail">Email :
        <a class="green-sea" data-ng-href="mailto:{{data.CustomerEmail}}">{{data.CustomerEmail}}</a>
    </h4>

    <h3 class="text-center" ng-if="!data.CustomerFirstName && !data.CustomerLastName && !data.CustomerEmail">
        CARTE
    </h3>

    <!-- Offers -->
    <ul class="izi-offers list-unstyled">
        <li data-ng-repeat="offer in data.Offers" class="{{offer.isValid ? 'bg-accent hvr-sink' : 'bg-rouge'}}"
            ng-click="showConfirm($event, offer)"
            style="background: url({{offer.OfferImageUrl}}) no-repeat center -35px; margin-bottom: 15px;">
            <b class="pull-right">x{{offer.counter === 0 ? 0 : offer.counter}}</b>
            <h4 class="text-center no-mg-vert">
                {{offer.OfferClassDescription}}
            </h4>

            <div class="text-center">
                <b>{{offer.OfferObjectDescription}}</b><br/>
            </div>
        </li>
    </ul>

    <!-- Balances -->
    <ul class="izi-balances list-unstyled">
        <li data-ng-repeat="balance in data.Balances"
            class="{{balance.Value > 0 ? 'bg-accent hvr-sink' : 'bg-rouge'}}"
            ng-click="balance.UseToPay ? showAdvanced($event, balance) : 0">
            <h4 class="text-center no-mg-vert">{{balance.BalanceName}}</h4>

            <div class="text-center">
                <b>Solde: {{balance.Value}} {{balance.BalanceType === 'Euros' ? '€' : balance.BalanceType}}</b>
            </div>
        </li>
    </ul>

    <h5 class="text-center light" ng-if="data.CustomerEmail"
        ng-init="bipDate = getDate(data.Barcodes[0].LastBipDate)" style="margin-bottom: 0">
        <small style="color: #777">Dernier passage le: {{bipDate.getDate() + '/' + bipDate.getMonth() + '/' +
            bipDate.getFullYear()}}
        </small>
    </h5>
</div>

<!-- LOGIN VIEW -->
<div ng-if="!barcode && !register" style="padding: 15px 15px 5px;">
    <h4 class="blanc text-center" style="font-weight: 700 !important">Veuillez saisir votre n° de carte pour accéder à
        votre compte</h4>

    <form name="iziLoginForm">
        <input type="tel" class="center-block" name="barcodeId" ng-model="form.barcode" style="line-height: 24px;"
               ng-minlength="8"
               maxlength="10"
               ng-enter="login()"
               ng-pattern="/^[0-9]*$/"
               placeholder="N° de carte&#8230;"
               ng-change="autoLogin()"
               onFocus="window.scrollTo(0, 0);"/>
    </form>

    <div class="clearfix">
        <button class="btn btn-lg center-block hvr-grow no-radius {{(iziLoginForm.barcodeId.$invalid || iziLoginForm.barcodeId.$pristine) ? 'bg-rouge' : 'bg-accent'}}"
                ng-disabled="iziLoginForm.barcodeId.$invalid || iziLoginForm.barcodeId.$pristine"
                ng-click="login()">Valider
        </button>
        <br/>
        <a href="" class="blanc cursor-pointer pull-right" ng-click="goRegister()">S'enregistrer</a>
    </div>
</div>

<!-- REGISTER VIEW -->
<div id="registerView" ng-if="register">
    <i class="glyphicon glyphicon-remove blanc pull-right hvr-grow"
       style="cursor: pointer; margin-top: 12px;margin-right: 12px"
       ng-click="backToLogin()"></i>

    <div class="container-fluid">
        <h3 class="blanc text-center">Enregistrer Ma Carte</h3><br/>

        <form name="registerForm" class="form-horizontal" novalidate>
            <div class="clearfix">
                <label for="barcode" class="col-sm-3">N° de carte</label>

                <div class="form-group col-sm-9">
                    <input id="barcode" class="form-control" type="text" ng-model="client.barcode"
                           placeholder="N° de carte&#8230;" ng-minlength="8" required=""/>
                </div>
            </div>

            <div class="clearfix">
                <label for="firstname" class="col-sm-3">Prénom</label>

                <div class="form-group col-sm-9">
                    <input id="firstname" class="form-control" type="text" ng-model="client.firstname"
                           placeholder="Prénom&#8230;" ng-minlength="2"
                           ng-pattern="/[a-zA-ZÀ-ÿ ][a-zA-ZÀ-ÿ ][a-zA-ZÀ-ÿ ]+/"
                           required=""/>
                </div>
            </div>
            <div class="clearfix">
                <label for="lastname" class="col-sm-3">Nom</label>

                <div class="form-group col-sm-9">
                    <input id="lastname" class="form-control" type="text" ng-model="client.lastname"
                           placeholder="Nom&#8230;" ng-minlength="2"
                           ng-pattern="/[a-zA-ZÀ-ÿ ][a-zA-ZÀ-ÿ ][a-zA-ZÀ-ÿ ]+/"
                           required=""/>
                </div>
            </div>
            <div class="clearfix">
                <label for="email" class="col-sm-3">Email</label>

                <div class="form-group col-sm-9">
                    <input id="email" class="form-control" type="email" ng-model="client.email"
                           placeholder="Adresse Email&#8230;"
                           ng-pattern="/^[_a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/"
                           required=""/>
                </div>
            </div>
            <div class="clearfix">
                <label for="tel" class="col-sm-3">Tél.</label>

                <div class="form-group col-sm-9">
                    <input id="tel" class="form-control" type="tel" ng-model="client.tel"
                           placeholder="N° de téléphone&#8230;"
                           ng-pattern="/^[0-9]+$/"
                           required=""/>
                </div>
            </div>
            <div class="clearfix">
                <label for="email" class="col-sm-3">Adresse</label>

                <div class="form-group col-sm-9">
                    <input id="address" class="form-control" type="text" ng-model="client.address"
                           placeholder="Adresse&#8230;" required=""/>
                </div>
            </div>
            <div class="clearfix">
                <label for="zipcode" class="col-sm-3">Code Postal</label>

                <div class="form-group col-sm-9">
                    <input id="zipcode" class="form-control" type="tel" ng-model="client.zipcode"
                           placeholder="Code Postal&#8230;" ng-minlength="5" maxlength="5"
                           required=""/>
                </div>
            </div>
            <div class="clearfix">
                <label for="email" class="col-sm-3">Ville</label>

                <div class="form-group col-sm-9">
                    <input id="city" class="form-control" type="text" ng-model="client.city"
                           placeholder="Ville&#8230;"
                           ng-minlength="2"
                           required=""/>
                </div>
            </div>
            <div class="clearfix">
                <label for="password" class="col-sm-3">Mot de Passe</label>

                <div class="form-group col-sm-9">
                    <input id="password" class="form-control" type="password" ng-model="client.password"
                           placeholder="Mot de passe&#8230;" ng-minlength="8" required=""/>
                </div>
            </div>
            <div class="clearfix">
                <label for="password" class="col-sm-3" style="padding-top: 0">Mot de Passe (confirmation)</label>

                <div class="form-group col-sm-9">
                    <input id="passwordConfirm" class="form-control" type="password"
                           ng-model="client.passwordConfirm"
                           placeholder="Mot de passe (confirmation)&#8230;"
                           compare-to="client.password"
                           ng-minlength="8"
                           required=""/>
                </div>
            </div>
            <div class="text-center">
                <button id="submitRegister"
                        class="btn bg-{{registerForm.$invalid ? 'rouge' : 'accent'}} btn-lg center-block text-center no-radius"
                        ng-disabled="registerForm.$invalid || registerForm.$pristine"
                        ng-click="submitRegister()">VALIDER
                </button>
            </div>
        </form>
    </div>
</div>
</div>

</div>

